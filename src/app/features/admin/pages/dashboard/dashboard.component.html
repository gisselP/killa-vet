<div class="background-gradient"></div>
<div id="dashboard" class="view-content active">
  <div class="container pt-5">
    <div class="row align-items-center text-center">
      <div class="d-flex flex-column">
        <h1 class="principal-title">Dashboard</h1>
        <p class="secondary-subtitle fs-6">
          Bienvenido de vuelta, aquí está tu resumen del día
        </p>
      </div>
    </div>
    <section class="d-flex justify-content-center">
      <section class="col-lg-9">
        <div class="row my-5">
          <div class="col-md-4 mb-3">
            <div class="glass-card">
              <div class="card-body">
                <div class="d-flex justify-content-between align-items-center">
                  <div>
                    <p class="text-muted mb-1">Total Mascotas</p>
                    <h3 class="mb-0">{{ totalMascotas }}</h3>
                    <small class="text-success">
                      <i class="bi bi-arrow-up"></i> 12% este mes
                    </small>
                  </div>
                  <div
                    class="stat-icon"
                    style="background: #dbeafe; color: #3b82f6"
                  >
                    <i class="bi bi-heart-fill"></i>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="col-md-4 mb-3">
            <div class="glass-card">
              <div class="card-body">
                <div class="d-flex justify-content-between align-items-center">
                  <div>
                    <p class="text-muted mb-1">Citas Hoy</p>
                    <h3 class="mb-0">{{ citas.length }}</h3>
                    <small class="text-info"
                      ><i class="bi bi-clock"></i> {{ textoPendientes }}</small
                    >
                  </div>
                  <div
                    class="stat-icon"
                    style="background: #dcfce7; color: #10b981"
                  >
                    <i class="bi bi-calendar-check-fill"></i>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="col-md-4 mb-3">
            <div class="glass-card">
              <div class="card-body">
                <div class="d-flex justify-content-between align-items-center">
                  <div>
                    <p class="text-muted mb-1">Emergencias</p>
                    <h3 class="mb-0">{{ numeroDeEmergencias }}</h3>
                    <small class="text-danger"
                      ><i class="bi bi-exclamation-triangle"></i> Atención
                      requerida</small
                    >
                  </div>
                  <div
                    class="stat-icon"
                    style="background: #fee2e2; color: #ef4444"
                  >
                    <i class="bi bi-heart-pulse-fill"></i>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>
    </section>
    <!-- Citas Próximas -->
    <div class="service-card no-lift mb-4">
      <div class="card-header bg-white pb-3">
        <h5 class="mb-0 text-green fw-bold">Próximas Citas de Hoy</h5>
      </div>
      <div class="card-body p-0">
        <div class="table-responsive">
          <table class="table table-hover mb-0">
            <thead class="table-light">
              <tr>
                <th>Fecha</th>
                <th>Hora</th>
                <th>Nombre mascota</th>
                <th>Motivo</th>
                <th>Observaciones</th>
                <th>Estado</th>
                <th>Acciones</th>
              </tr>
            </thead>
            <tbody>
              @for(cita of citas; track $index){
              <tr>
                <td>
                  <strong>{{ cita.fecha | date : "dd/MM/yyyy" }}</strong>
                </td>
                <td>
                  <strong>{{ cita.hora }}</strong>
                </td>
                <td>{{ cita.nombre }}</td>
                <td>{{ cita.motivo }}</td>
                <td>{{ cita.observaciones || "-" }}</td>
                <td>
                  <span
                    class="badge-status px-1 rounded"
                    [ngClass]="{
                      'bg-warning-subtle fw-semibold text-warning':
                        cita.estado === 'PENDIENTE',
                      'bg-success-subtle fw-semibold text-success':
                        cita.estado === 'COMPLETADA',
                      'bg-danger-subtle fw-semibold text-danger':
                        cita.estado === 'CANCELADA'
                    }"
                  >
                    {{ cita.estado || "PENDIENTE" }}
                  </span>
                </td>
                <td>
                  <section class="d-flex gap-2">
                    @if(cita.estado !== 'COMPLETADA' && cita.estado !==
                    'CANCELADA'){
                    <button
                      class="btn btn-sm btn-success btn-action"
                      (click)="cambiarEstado($index, 'COMPLETADA')"
                    >
                      <i class="bi bi-check-lg"></i>
                    </button>
                    <button
                      class="btn btn-sm btn-danger btn-action me-1"
                      (click)="cambiarEstado($index, 'CANCELADA')"
                    >
                      <i class="bi bi-x-lg"></i>
                    </button>
                    }
                  </section>
                </td>
              </tr>
              }
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>

  <div class="background-decoration decoration-1"></div>
  <div class="background-decoration decoration-2"></div>
  <div class="background-decoration decoration-3"></div>
</div>
